---
phase: 08-polish-pwa
plan: 03
type: execute
domain: frontend-design
---

<objective>
Create unified responsive layout with compact header, maximized grid, and single clue bar with navigation.

Purpose: Provide consistent solving experience across all devices with maximum grid visibility.
Output: SolveLayout component, redesigned header with compact tooling, clue bar with prev/next navigation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-polish-pwa/08-CONTEXT.md
@.planning/phases/08-polish-pwa/08-RESEARCH.md
@.planning/phases/08-polish-pwa/08-02-PLAN.md
@src/components/ClueBar.tsx
@src/components/ClueBar.css
@src/components/Toolbar.tsx
@src/components/CollaboratorAvatars.tsx

**Tech stack available:** React 19, CSS custom properties
**Established patterns:** CSS Grid, Flexbox

**From CONTEXT.md (solving view mockup):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† â”‚ NYT â€¢ Jan 12      â”‚ â—â— â”‚ ğŸ“¤ â”‚ â‹® â”‚   â”‚  â† Header (â—â— = collaborators)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         [Maximized Grid]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â—€  â”‚  3A: "Small or insignificant"  â”‚ â–¶ â”‚  â† Clue bar with nav
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         [Keyboard area - Plan 04]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key layout changes:**
- Single clue bar (no dual-panel clue list)
- Compact header with back button, puzzle info, collaborators, share, menu
- Grid maximized in available space
- Keyboard area at bottom (handled in Plan 04)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SolveLayout shell component</name>
  <files>src/components/Layout/SolveLayout.tsx, src/components/Layout/SolveLayout.css</files>
  <action>
Create layout shell for solving view:

**SolveLayout.tsx:**
- Props: header (ReactNode), grid (ReactNode), clueBar (ReactNode), keyboard (ReactNode | null)
- Uses CSS Grid with areas: header, grid, clue-bar, keyboard
- Grid area uses flex-grow to maximize space
- Responsive: same structure on all screen sizes, just scales
- Uses 100dvh for full viewport height (dynamic viewport height for mobile)

**SolveLayout.css:**
- .solve-layout as grid container
- Grid template: header (auto) | grid (1fr) | clue-bar (auto) | keyboard (auto)
- Use theme CSS variables for backgrounds
- Ensure no scroll on main container (grid handles overflow internally)

This is just the structural shell - content components passed as props.
  </action>
  <verify>TypeScript compiles, component renders empty areas</verify>
  <done>SolveLayout shell with header/grid/clue-bar/keyboard areas</done>
</task>

<task type="auto">
  <name>Task 2: Create compact header component</name>
  <files>src/components/Layout/SolveHeader.tsx, src/components/Layout/SolveHeader.css</files>
  <action>
Create compact header for solving view:

**SolveHeader.tsx:**
Props:
- puzzleTitle: string
- puzzleDate?: string (formatted display date)
- onBack: () => void
- onShare: () => void
- onMenuClick: () => void
- collaborators: Collaborator[]
- menuContent: ReactNode (Toolbar dropdown menus)
- connectionState: 'connecting' | 'connected' | 'disconnected'

Layout (left to right):
1. Back button (â†) with onBack handler
2. Puzzle info (title + date, truncated if long)
3. Spacer (flex-grow)
4. Collaborator dots (compact, overlapping) - reuse/adapt CollaboratorAvatars
5. Connection indicator (dot only, colored by state)
6. Share button (icon only on mobile, "Share" on desktop)
7. Menu button (â‹®) that reveals Toolbar dropdowns

**SolveHeader.css:**
- Horizontal flexbox layout
- Height: ~48-56px
- Background: var(--color-bg-secondary)
- Use theme variables for all colors
- Responsive: collapse labels on small screens
  </action>
  <verify>Component compiles, renders with all props</verify>
  <done>Compact header with back, puzzle info, collaborators, share, menu</done>
</task>

<task type="auto">
  <name>Task 3: Upgrade ClueBar with prev/next navigation</name>
  <files>src/components/ClueBar.tsx, src/components/ClueBar.css</files>
  <action>
Upgrade ClueBar to include navigation buttons:

**ClueBar.tsx changes:**
Add props:
- onPrevClue: () => void
- onNextClue: () => void
- hasPrev: boolean
- hasNext: boolean

Layout:
1. Prev button (â—€ or â†) - disabled if !hasPrev
2. Clue text (existing) - flex-grow, centered
3. Next button (â–¶ or â†’) - disabled if !hasNext

Navigation behavior (implemented in usePuzzleState or App):
- Steps through clues sequentially by number within current direction
- Does NOT wrap (per established pattern - stop at ends)
- Updates selectedCell to first cell of new clue

**ClueBar.css updates:**
- Flexbox layout with buttons on sides
- Button styling using theme variables
- Disabled state styling
- Text truncation with ellipsis for long clues
  </action>
  <verify>Component compiles with new props</verify>
  <done>ClueBar with prev/next navigation buttons</done>
</task>

<task type="auto">
  <name>Task 4: Integrate new layout in App.tsx</name>
  <files>src/App.tsx, src/hooks/usePuzzleState.ts</files>
  <action>
Integrate new layout components:

**usePuzzleState.ts changes:**
Add clue navigation functions:
- `goToPrevClue(): void` - select previous clue in current direction
- `goToNextClue(): void` - select next clue in current direction
- `hasPrevClue: boolean` - true if there's a previous clue
- `hasNextClue: boolean` - true if there's a next clue

Logic: Get sorted list of clue numbers for current direction, find current, move to prev/next.

**App.tsx changes:**
When activeView === 'solve':
1. Wrap puzzle UI in SolveLayout
2. Use SolveHeader for header slot
3. Pass upgraded ClueBar to clue-bar slot
4. Pass null to keyboard slot for now (Plan 04 adds keyboard)
5. Remove old header elements now handled by SolveHeader
6. Wire up all event handlers
  </action>
  <verify>npm run dev - solving view uses new layout structure</verify>
  <done>New unified layout integrated in App.tsx</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Unified responsive layout with compact header and clue navigation</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Open a puzzle from library
    3. Verify compact header shows:
       - Back button (returns to library)
       - Puzzle title
       - Collaborator dots (if in P2P session)
       - Share button
       - Menu (check/reveal dropdowns)
    4. Verify clue bar shows:
       - Prev/Next buttons
       - Current clue text
       - Buttons navigate through clues
    5. Verify grid is maximized in available space
    6. Test on mobile viewport (DevTools responsive mode)
       - Same layout structure, just scaled
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Compact header with all elements
- [ ] Clue bar with working prev/next navigation
- [ ] Grid maximized in layout
- [ ] Responsive on mobile viewports
- [ ] Back to library navigation works
</verification>

<success_criteria>

- All tasks completed
- Unified layout structure in place
- Clue navigation works correctly
- No regressions in puzzle solving
- Responsive design consistent across viewports
</success_criteria>

<output>
After completion, create `.planning/phases/08-polish-pwa/08-03-SUMMARY.md`
</output>
