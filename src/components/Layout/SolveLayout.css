/**
 * SolveLayout: Full-viewport grid container for puzzle solving
 *
 * Uses CSS Grid with template areas:
 * - header: auto height
 * - grid: 1fr (takes remaining space)
 * - clue-bar: auto height
 * - keyboard: auto height (only when present)
 */

.solve-layout {
  /* CSS variables for layout calculations */
  --header-height: 48px;
  --clue-bar-height: 52px;
  --keyboard-height: 160px;
  --grid-padding: 8px;

  display: flex;
  flex-direction: column;
  /* Fallback for browsers without dvh support */
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height for mobile */
  width: 100%;
  overflow: hidden;
  background-color: var(--color-bg);
}

.solve-layout__header {
  flex: 0 0 auto;
  min-height: var(--header-height);
  position: relative;
  z-index: 100; /* Ensure header dropdowns appear above grid */
}

.solve-layout__grid {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  padding: var(--grid-padding);
  min-height: 0; /* Critical: allow flex child to shrink below content size */
  position: relative; /* For absolute positioned overlays */
}

/**
 * Puzzle Grid Area: Container that fills the grid slot
 * Separates title/author from the grid measurement area
 */
.puzzle-grid-area {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 0;
  overflow: hidden;
  width: 100%;
}

/**
 * Puzzle Grid Header: Contains title and author
 * Takes only its natural height, doesn't grow
 */
.puzzle-grid-header {
  flex: 0 0 auto;
  text-align: center;
  padding-bottom: 0.25rem;
  width: 100%;
  max-width: 100%;
  overflow: hidden;
}

/* Title styling within header */
.puzzle-grid-header .puzzle-title-above-grid {
  margin: 0 0 0.25rem 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 0 0.5rem;
}

/* Author styling within header - reduced margin on mobile */
.puzzle-grid-header .puzzle-author {
  margin: 0 0 0.25rem 0;
  font-size: 0.75rem;
}

/**
 * Puzzle Grid Wrapper: Contains the CrosswordGrid component
 * Takes remaining space after header, enabling accurate size measurement
 */
.puzzle-grid-wrapper {
  flex: 1 1 auto;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 0;
  width: 100%;
  overflow: hidden;
}

.solve-layout__clue-bar {
  flex: 0 0 auto;
  display: flex;
  justify-content: center;
  padding: 0.25rem 0.5rem;
}

.solve-layout__keyboard {
  flex: 0 0 auto;
}

/* When keyboard is not present, don't leave empty space */
.solve-layout__keyboard:empty {
  display: none;
}

/* Desktop layout: header at top, content fills remaining space */
@media (min-width: 768px) {
  .solve-layout__grid {
    flex: 1 1 auto;
    justify-content: center;
  }

  .solve-layout__clue-bar {
    margin-top: 1rem;
  }

  /* Hide keyboard on desktop by default - only show when enough height */
  .solve-layout__keyboard {
    display: none;
  }
}

/* Only show desktop keyboard when there's enough vertical space */
@media (min-width: 768px) and (min-height: 700px) {
  .solve-layout__keyboard {
    margin-top: 0.5rem;
    display: flex;
    justify-content: center;
  }
}
