---
phase: 02-puzzle-core
plan: 03
type: execute
---

<objective>
Add clue display bar and current word highlighting to complete the puzzle-solving experience.

Purpose: Provide essential visual context so solvers always know which clue they're working on and can see the full word they're filling in.
Output: Bottom bar showing current clue, highlighted word cells, and visual polish for a complete single-player solving experience.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-puzzle-core/02-CONTEXT.md

# Prior plans in this phase:
@.planning/phases/02-puzzle-core/02-01-SUMMARY.md
@.planning/phases/02-puzzle-core/02-02-SUMMARY.md

# Key files (will exist after Plans 01-02):
@src/types/puzzle.ts
@src/components/CrosswordGrid.tsx
@src/hooks/usePuzzleState.ts
@src/App.tsx

**Tech stack available:** Vite, React 19, TypeScript 5.9
**Established patterns:** Dark theme (#1a1a2e bg, #e0e0e0 text), component organization
**From 02-CONTEXT.md:**
- Bottom bar for current clue display
- Visual highlight of the current word
- Grid with clue should feel responsive and intuitive
</context>

<tasks>

<task type="auto">
  <name>Task 1: Calculate and expose current word from hook</name>
  <files>src/hooks/usePuzzleState.ts</files>
  <action>
Add current word calculation to usePuzzleState hook:

1. Create helper function `getCurrentWord(puzzle, selectedCell, direction)`:
   - Find the clue that contains the selected cell in the given direction
   - Return array of cell coordinates that form that word
   - Return null if no valid word (e.g., selected cell is black or no clue exists)

2. Add `currentClue` to the hook's return value:
   - Look up the Clue object for the current word
   - Return { number, direction, text } or null

3. The hook already exposes `currentWord` with cells - ensure it uses this new logic.

Implementation notes:
- For a given cell and direction, find the clue whose starting position + length covers this cell
- Across words: same row, columns from clue.col to clue.col + clue.length - 1
- Down words: same column, rows from clue.row to clue.row + clue.length - 1
  </action>
  <verify>Hook compiles, currentWord and currentClue are defined</verify>
  <done>Hook exports currentWord (cells array) and currentClue (clue object)</done>
</task>

<task type="auto">
  <name>Task 2: Add current word highlighting to grid</name>
  <files>src/components/CrosswordGrid.tsx, src/components/CrosswordGrid.css</files>
  <action>
Update CrosswordGrid to highlight all cells in the current word:

Props update: Add `currentWord: { row: number, col: number }[] | null`

Visual behavior:
- Cells in currentWord get a distinct background (e.g., #3a3a5e - slightly lighter than default)
- Selected cell still has the brightest highlight (border + background)
- Word cells have subtle highlight (background only, no special border)
- Use a CSS class like `.cell--in-word` for word highlighting

Ensure the visual hierarchy is clear:
1. Black cells (darkest, no interaction)
2. Regular white cells (standard background)
3. Current word cells (slightly highlighted)
4. Selected cell (brightest, with border)
  </action>
  <verify>Select a cell, see entire word highlighted with selected cell distinct</verify>
  <done>Current word visually highlighted, selected cell stands out within word</done>
</task>

<task type="auto">
  <name>Task 3: Create ClueBar component</name>
  <files>src/components/ClueBar.tsx, src/components/ClueBar.css</files>
  <action>
Create a clue display bar that shows the current clue:

Props: { clue: { number: number, direction: 'across' | 'down', text: string } | null }

Display format: "3 Across: Sleeping furniture" or "1 Down: Feline pet"
- If no clue selected, show empty or placeholder text ("Select a cell to see clue")

Styling:
- Fixed position at bottom of puzzle area (not viewport - within app container)
- Dark background matching theme (#252538 or similar)
- Padding for comfortable reading
- Clue number and direction in slightly different color/weight for emphasis
- Text should be readable but not too large (1rem-1.1rem)
- Max-width matches grid width
  </action>
  <verify>ClueBar renders, shows clue text when cell selected</verify>
  <done>ClueBar displays current clue with proper formatting</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete puzzle-solving UI with grid, navigation, input, word highlighting, and clue display</what-built>
  <how-to-verify>
    1. Run: `npm run dev`
    2. Visit: http://localhost:5173
    3. Test grid navigation:
       - Click a white cell - should select it (highlighted border)
       - Click same cell again - direction should toggle (across<->down)
       - Use arrow keys to move around (should skip black cells)
    4. Test letter input:
       - Type a letter - should appear in cell and auto-advance
       - Type at end of word - should stay in place
       - Press Backspace - should clear and move back
    5. Test word highlighting:
       - When cell selected, entire word should be subtly highlighted
       - Selected cell should be brightest within the highlighted word
    6. Test clue display:
       - ClueBar at bottom should show current clue
       - Format like "1 Across: Feline pet"
       - Toggling direction should show corresponding clue
    7. Verify dark theme consistency - all elements should match the established palette
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] Grid renders with proper styling
- [ ] Keyboard navigation works (arrows, letters, backspace)
- [ ] Same-cell click toggles direction
- [ ] Current word highlighted
- [ ] ClueBar shows current clue
- [ ] All visuals match dark theme
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verification checkpoint approved
- Phase 2 complete: core puzzle-solving experience functional
</success_criteria>

<output>
After completion, create `.planning/phases/02-puzzle-core/02-03-SUMMARY.md` with:
- Summary of all three plans
- Complete file list for phase
- Note that Phase 2: Puzzle Core is complete
- Ready for Phase 3: Puzzle Import
</output>
