---
phase: 08-polish-pwa
plan: 02
type: execute
domain: frontend-design
---

<objective>
Create puzzle library view as the new home screen with puzzle list grouped by date.

Purpose: Transform the app from "always show a puzzle" to a proper library-centric experience.
Output: LibraryView component with puzzle cards, progress indicators, date grouping.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-polish-pwa/08-CONTEXT.md
@.planning/phases/08-polish-pwa/08-RESEARCH.md
@.planning/phases/08-polish-pwa/08-01-PLAN.md
@src/lib/puzzleStorage.ts
@src/App.tsx

**Tech stack available:** React 19, Vite, IndexedDB (y-indexeddb), CSS custom properties
**Established patterns:** IndexedDB for puzzle storage, localStorage for timeline mappings
**Constraining decisions:**
- Library is new home screen
- Grouped by date, source as headline
- Progress indicators for each puzzle

**From CONTEXT.md (ASCII mockup):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Crossing Words            â”‚ â• â”‚ ğŸ“¥ â”‚   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”€â”€â”€ January 12, 2026 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  NYT Crossword            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%â”‚
â”‚  Washington Post          â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%â”‚
â”‚ â”€â”€â”€ January 11, 2026 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  NYT Crossword            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ âœ“  â”‚
â”‚  LA Times                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0% â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend puzzle storage for library management</name>
  <files>src/lib/puzzleStorage.ts</files>
  <action>
Add functions to puzzleStorage.ts for library management:

1. `listAllPuzzles(): Promise<PuzzleEntry[]>` - Returns all saved puzzles with metadata
   - PuzzleEntry: { id: string, title: string, author?: string, date?: string, source?: string, savedAt: number }
   - Use IndexedDB cursor to iterate all stored puzzles

2. `deletePuzzle(puzzleId: string): Promise<void>` - Deletes puzzle from storage
   - Also clear associated CRDT data if possible

3. `getPuzzleProgress(puzzleId: string): Promise<{ filled: number, total: number }>` - Calculate fill percentage
   - Query y-indexeddb for the puzzle's user entries
   - Count filled cells vs total fillable cells

Note: May need to store puzzle metadata separately from puzzle data for efficient listing.
Consider adding a puzzles-meta store if needed for performance.
  </action>
  <verify>TypeScript compiles without errors</verify>
  <done>Library management functions available in puzzleStorage</done>
</task>

<task type="auto">
  <name>Task 2: Create LibraryView and PuzzleCard components</name>
  <files>src/components/Library/LibraryView.tsx, src/components/Library/LibraryView.css, src/components/Library/PuzzleCard.tsx, src/components/Library/PuzzleCard.css</files>
  <action>
Create library view components using theme CSS variables:

**PuzzleCard.tsx:**
- Props: puzzle entry, progress (filled/total), onOpen, onDelete
- Shows source/title as main text
- Progress bar using filled/total percentage
- Completed state (checkmark instead of percentage)
- Delete button (no confirmation per CONTEXT.md - puzzles can be re-downloaded)
- Subtle hover effect

**LibraryView.tsx:**
- Props: onOpenPuzzle, onImportPuzzle, onDownloadPuzzle
- Header with "Crossing Words" title and action buttons (import file, download)
- Groups puzzles by date (use savedAt or puzzle date if available)
- Shows "No puzzles yet" empty state with call-to-action
- Each group shows date as section header
- Maps puzzles to PuzzleCard components

Use CSS Grid or Flexbox for responsive layout.
Style with var(--color-*) from theme.css.
Follow existing component patterns from Toolbar.tsx, ShareDialog.tsx.
  </action>
  <verify>Components compile, render without errors</verify>
  <done>LibraryView with PuzzleCard showing puzzle list grouped by date</done>
</task>

<task type="auto">
  <name>Task 3: Integrate library as home screen in App.tsx</name>
  <files>src/App.tsx</files>
  <action>
Refactor App.tsx to use library as home:

1. Add `activeView: 'library' | 'solve'` state, default to 'library'
2. When activeView is 'library':
   - Render LibraryView
   - Pass handlers for open puzzle, import, download
3. When activeView is 'solve':
   - Render current puzzle solving UI
   - Add "Back to Library" button in header
4. On puzzle open from library:
   - Load puzzle, set activeView to 'solve'
5. On puzzle import/download:
   - Save puzzle, optionally open immediately (set activeView to 'solve')
6. Handle URL hash for shared sessions:
   - If URL has timeline, go directly to solve view (existing behavior)
   - Clear URL hash when returning to library

Keep existing puzzle solving logic, just wrap in conditional rendering.
  </action>
  <verify>npm run dev - app shows library on load, clicking puzzle opens solve view</verify>
  <done>Library is home screen, solve view accessible via puzzle selection</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Library view as home screen with puzzle cards, progress indicators, and navigation</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:5173
    3. Verify library view shows (not puzzle directly)
    4. Import or download a puzzle
    5. Verify puzzle appears in library with progress bar
    6. Click puzzle to open solve view
    7. Verify "Back" button returns to library
    8. Verify URL hash handling still works for shared sessions
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Library view shows as home screen
- [ ] Puzzles grouped by date with progress indicators
- [ ] Navigation between library and solve view works
- [ ] Shared session URLs still work (direct to solve view)
</verification>

<success_criteria>

- All tasks completed
- Library as home screen
- Puzzle cards with progress bars
- Seamless navigation between views
- No regressions in existing functionality
</success_criteria>

<output>
After completion, create `.planning/phases/08-polish-pwa/08-02-SUMMARY.md`
</output>
